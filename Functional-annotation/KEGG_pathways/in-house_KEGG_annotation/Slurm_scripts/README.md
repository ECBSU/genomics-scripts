# Slurm script to run the KEGGstand pipeline
## Info
These scripts are the slurm (bash) scripts to automate running the KEGGstand script on the OIST Deigo server. These scripts can (**after coding in your input**) directly be run on Deigo.

## Input
The script takes a directory as input, and analyzes each fasta file in the directory. The KEGGstand_genome.slurm takes genome or MAG fastas and the KEGGstand_protein.slurm takes protein
sequence fastas (this can easily be changed by changing the EggNOG command in the slurm script).

**The input of slurm batch scripts needs to be hardcoded, so has to be adjusted in the script itself.
Download the .slurm script and change the following lines to suit your case:**

Line 8: #SBATCH --array=0-0 <-- Change the array size to fit your number of samples (0-0 = 1 sample, 0-1 = 2 samples, 0-2 = 3, etc.)

Line 16: input_dir=/path/to/dir <-- Change the path to the path of your directory containing the fasta files  

Line 17: output_dir=/path/to/dir <-- Change the path to your desired output folder (probably somewhere on /flash/HusnikU)  

Line 18: extension=.fasta <-- Change "fasta" to the extension used in your fasta file (usually fna, faa, fa, or fasta)  

Line 19: (OPTIONAL) By default, the EggNOG command will search the standard EggNOG database. More specific databases generally work better. You can change the searched database by changing
the path on this line, with the appropriate database. We currently have:  
**Archaea**: /bucket/HusnikU/Databases/EggNOG_mmseqs2_databases/Archaea.mmseqs/Archaea.mmseqs  
**Bacteria**: /bucket/HusnikU/Databases/EggNOG_mmseqs2_databases/Bacteria.mmseqs/Bacteria.mmseqs  
**Eukaryotes**: /bucket/HusnikU/Databases/EggNOG_mmseqs2_databases/Eukaryotes.mmseqs/Eukaryotes.mmseqs  
**Insects**:  /bucket/HusnikU/Databases/EggNOG_mmseqs2_databases/Insecta.mmseqs/Insecta.mmseqs  
**Rickettsiales**: /bucket/HusnikU/Databases/EggNOG_mmseqs2_databases/Rickettsiales.mmseqs/Rickettsiales.mmseqs  
**Vibrionales**: /bucket/HusnikU/Databases/EggNOG_mmseqs2_databases/Vibrionales.mmseqs/Vibrionales.mmseqs  
**Viridiplantae**: /bucket/HusnikU/Databases/EggNOG_mmseqs2_databases/Viridiplantae.mmseqs/Viridiplantae.mmseqs

After coding in your input, simply run the script on Deigo:
```
sbatch KEGGstand_genome.slurm
```
or 
```
sbatch KEGGstand_protein.slurm
```
## Output
The output will be generated in the specified folder. It includes the regular EggNOG output, and 3 text files generated by 
the python scripts. By default these are:

**input_fasta.emapper.annotations_KEGG_complete_modules.tsv** = Tab-delimited text file only containing the modules found to be 
100% complete. The columns from left to right are: KEGG entry, KEGG name, highest completion (as a fraction 0-1), the genes comprising the most complete pathways, and any potential non-essential genes found for the module.  

**input_fasta.emapper.annotations_KEGG_completion.tsv** = Tab-delimited text file showing the found completion for each KEGG
module. The columns from left to right are: KEGG entry, KEGG name, highest completion expressed as a fraction, the genes comprising the most complete pathways, and any potential non-essential genes found for the module.  

**input_fasta.emapper.annotations_pathway_and_BRITE**: Tab-delimited text file containing two columns. The first column is every KEGG pathway or BRITE category that contains genes (with k-terms), listed in hierarchical fashion. 
The second column is the number of genes found for the pathway or BRITE category within the EggNOG output, given as a fraction of the total number of genes known for the category (e.g. 3/14).
